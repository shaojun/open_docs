# 需求
客户直接需求: 云端需要收集报警起始到结束时间段的视频片段.

进一步的需求:
* 不需要通过第三方摄像头平台来传送视频
* 对各品牌摄像头的视频采集具有通用性
* 边缘能够按需调用摄像头的私有API    
  因不走第三方摄像头平台后,一些摄像头功能也将无法简单实现,那就需要在本地进行私有API调用,以实现摄像头设置, 语音播放, MIC收集声音并传送给云端等.

# 方案
## 报警视频上传
### 边缘    
因为从云端来的报警视频获取请求总是不可预计和滞后的, 所以边缘需要不断的持久化摄像头实时视频到本地文件存储, 从而等待云端的滞后请求, 再选择性上传对应时间段的视频片段.
> 持久化的时间肯定是长一些较好,这样给云端留下了操作的空间, 而此时间是基本由边缘本地的存储空间决定的.
> 按720P的视频流, 2Mb码率计算, 每1小时约需要 1GB的空间.
> 按1126板子,半载存储是16GB,而最终实际可用约为4GB, 所以最多存储4小时.
#### 任务    
* 缓存rtsp视频流到本地    
  以每1分钟为单位进行存储.
* 清理本地视频文件
  一定时间后,将自动删除最老的视频文件.
* 等待后端请求
  需要与云端共同定义请求消息的发送方式和格式内容.
* 开始上传
  上传失败要有重试

### 视频服务后端
在收到某个报警结束的通知后,马上向边缘发请视频片段获取请求.
#### 任务
* 向边缘发送消息
  需要与边缘端共同定义请求消息的发送方式和格式内容.
* 开放上传路径
* 拼接视频
